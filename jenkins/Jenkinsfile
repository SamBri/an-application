// Jenkinsfile (Declarative Pipeline)
pipeline {
   agent any
   
   
   stages {
      stage('Build') {
         steps {
            echo 'Building stage'
            sh 'mvn compile'
            sh 'mvn package'
            
         }
      }
      
      stage('Deploy') {
         when {
            expression {
               currentBuild.result == null || currentBuild.result == 'SUCCESS'
            }
         }
         
         // unset --
         steps {
            echo 'delivering app for deployment.'
            sh 'scp ./target/application-1.0.jar appuser@192.168.0.190:/home/appuser/apps/'
            sh 'ssh appuser@192.168.0.190 "nohup java -jar /apps/application-1.0.jar  &"'
            
            
         }
      }
      
   }
   
   }
   
